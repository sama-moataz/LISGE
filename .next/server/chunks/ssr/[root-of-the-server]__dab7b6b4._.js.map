{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase.ts"],"sourcesContent":["\nimport { initializeApp, getApps, getApp, type FirebaseOptions } from 'firebase/app';\nimport { \n  getAuth, \n  // GoogleAuthProvider, // No longer needed here for login page\n  // PhoneAuthProvider, // No longer needed here for login page\n  // RecaptchaVerifier // No longer needed here for login page\n} from 'firebase/auth';\nimport { getFirestore, serverTimestamp } from 'firebase/firestore';\n\nconst apiKey = process.env.NEXT_PUBLIC_FIREBASE_API_KEY;\n\nif (!apiKey || typeof apiKey !== 'string' || apiKey.trim() === \"\") {\n  const errorMessage = \"CRITICAL_CONFIG_ERROR: Firebase API Key (NEXT_PUBLIC_FIREBASE_API_KEY) is missing, empty, not a string, or not loaded properly from .env.local. Application cannot initialize Firebase. Please verify your .env.local file in the project root and restart your Next.js development server.\";\n  console.error(errorMessage);\n  // For server-side, throw to halt if critical config is missing.\n  // For client-side, this error will likely be caught by initializeApp if this check somehow passes.\n  if (typeof window === 'undefined') { \n    throw new Error(errorMessage);\n  }\n}\n\nconst firebaseConfig: FirebaseOptions = {\n  apiKey: apiKey,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID, // Optional, keep if used elsewhere\n};\n\nconsole.log(\"Attempting to load Firebase config from environment variables:\");\nconsole.log(\"NEXT_PUBLIC_FIREBASE_API_KEY:\", process.env.NEXT_PUBLIC_FIREBASE_API_KEY ? \"Loaded\" : \"MISSING or empty\");\nconsole.log(\"NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:\", process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN);\nconsole.log(\"NEXT_PUBLIC_FIREBASE_PROJECT_ID:\", process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID);\n\n// Initialize Firebase\nlet app;\nif (!getApps().length) {\n  try {\n     if (!firebaseConfig.authDomain || !firebaseConfig.projectId) {\n        const errorMsg = `CRITICAL_CONFIG_ERROR: Essential Firebase config values (authDomain, projectId) are missing or undefined in firebaseConfig. Check .env.local and restart server. AuthDomain: ${firebaseConfig.authDomain}, ProjectID: ${firebaseConfig.projectId}`;\n        console.error(errorMsg);\n        if (typeof window === 'undefined') {\n            throw new Error(errorMsg);\n        }\n    }\n    app = initializeApp(firebaseConfig);\n    console.log('Firebase app initialization attempted.');\n  } catch (error: any) {\n    console.error('CRITICAL_ERROR_DURING_FIREBASE_INIT:', error.message, error.code);\n    console.error('Attempted Firebase Config (API Key Redacted):', JSON.stringify({ ...firebaseConfig, apiKey: firebaseConfig.apiKey ? 'REDACTED' : 'MISSING/INVALID' }));\n    throw error; \n  }\n} else {\n  app = getApp();\n  console.log('Existing Firebase app retrieved.');\n}\n\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n// const googleAuthProvider = new GoogleAuthProvider(); // No longer needed for login page\n\n// RecaptchaVerifier is still exported for potential future use or if other parts of the app might use phone auth.\n// If truly not needed anywhere, it can be fully removed.\nexport { app, auth, db, serverTimestamp };\n// Export RecaptchaVerifier separately if it's needed elsewhere but not in this direct context\nexport { RecaptchaVerifier } from 'firebase/auth';\n"],"names":[],"mappings":";;;;;AACA;AAAA;AACA;AAAA;AAMA;AAAA;;;;AAEA,MAAM;AAEN,IAAI,CAAC,UAAU,OAAO,WAAW,YAAY,OAAO,IAAI,OAAO,IAAI;IACjE,MAAM,eAAe;IACrB,QAAQ,KAAK,CAAC;IACd,gEAAgE;IAChE,mGAAmG;IACnG,wCAAmC;QACjC,MAAM,IAAI,MAAM;IAClB;AACF;AAEA,MAAM,iBAAkC;IACtC,QAAQ;IACR,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,eAAe,QAAQ,GAAG,CAAC,mCAAmC;AAChE;AAEA,QAAQ,GAAG,CAAC;AACZ,QAAQ,GAAG,CAAC,iCAAiC,uCAA2C;AACxF,QAAQ,GAAG,CAAC;AACZ,QAAQ,GAAG,CAAC;AAEZ,sBAAsB;AACtB,IAAI;AACJ,IAAI,CAAC,CAAA,GAAA,oLAAA,CAAA,UAAO,AAAD,IAAI,MAAM,EAAE;IACrB,IAAI;QACD,IAAI,CAAC,eAAe,UAAU,IAAI,CAAC,eAAe,SAAS,EAAE;YAC1D,MAAM,WAAW,CAAC,6KAA6K,EAAE,eAAe,UAAU,CAAC,aAAa,EAAE,eAAe,SAAS,EAAE;YACpQ,QAAQ,KAAK,CAAC;YACd,wCAAmC;gBAC/B,MAAM,IAAI,MAAM;YACpB;QACJ;QACA,MAAM,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE;QACpB,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,wCAAwC,MAAM,OAAO,EAAE,MAAM,IAAI;QAC/E,QAAQ,KAAK,CAAC,iDAAiD,KAAK,SAAS,CAAC;YAAE,GAAG,cAAc;YAAE,QAAQ,eAAe,MAAM,GAAG,aAAa;QAAkB;QAClK,MAAM;IACR;AACF,OAAO;IACL,MAAM,CAAA,GAAA,oLAAA,CAAA,SAAM,AAAD;IACX,QAAQ,GAAG,CAAC;AACd;AAEA,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AACrB,MAAM,KAAK,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firestoreService.ts"],"sourcesContent":["\n'use server';\n\nimport { db } from '@/lib/firebase';\nimport type { Scholarship } from '@/types';\nimport {\n  collection,\n  getDocs,\n  addDoc,\n  updateDoc,\n  deleteDoc,\n  doc,\n  serverTimestamp,\n  query,\n  orderBy,\n  Timestamp,\n  getDoc,\n  where,\n  writeBatch,\n} from 'firebase/firestore';\nimport { auth } from '@/lib/firebase';\n\n\nconst SCHOLARSHIPS_COLLECTION = 'SCHOLARSHIPS';\n\nconst mapDocToScholarship = (docSnapshot: any): Scholarship => {\n  const data = docSnapshot.data();\n  return {\n    id: docSnapshot.id,\n    name: data.name || '',\n    description: data.description || '',\n    eligibility: data.eligibility || '',\n    websiteUrl: data.websiteUrl || '',\n    iconName: data.iconName || undefined,\n    category: data.category || undefined,\n    location: data.location || 'Global',\n    ageRequirement: data.ageRequirement || undefined,\n    fundingLevel: data.fundingLevel || undefined,\n    destinationRegion: data.destinationRegion || undefined,\n    targetLevel: data.targetLevel || undefined,\n    fundingCountry: data.fundingCountry || undefined,\n    partner: data.partner || undefined,\n    coverage: data.coverage || undefined,\n    deadline: data.deadline || undefined,\n    imageUrl: data.imageUrl || undefined,\n    createdAt: data.createdAt instanceof Timestamp ? data.createdAt : undefined,\n    updatedAt: data.updatedAt instanceof Timestamp ? data.updatedAt : undefined,\n  } as Scholarship;\n};\n\n\nexport async function getScholarships(): Promise<Scholarship[]> {\n  try {\n    const scholarshipsRef = collection(db, SCHOLARSHIPS_COLLECTION);\n    const q = query(scholarshipsRef, orderBy('createdAt', 'desc'));\n    const querySnapshot = await getDocs(q);\n    return querySnapshot.docs.map(mapDocToScholarship);\n  } catch (error) {\n    console.error(\"[firestoreService] Error fetching scholarships: \", error);\n    throw new Error(\"Failed to fetch scholarships.\");\n  }\n}\n\nexport async function getScholarshipById(id: string): Promise<Scholarship | null> {\n  try {\n    const scholarshipDocRef = doc(db, SCHOLARSHIPS_COLLECTION, id);\n    const docSnap = await getDoc(scholarshipDocRef);\n    if (docSnap.exists()) {\n      return mapDocToScholarship(docSnap);\n    }\n    return null;\n  } catch (error) {\n    console.error(`[firestoreService] Error fetching scholarship with ID ${id}: `, error);\n    throw new Error(`Failed to fetch scholarship ${id}.`);\n  }\n}\n\nexport async function addScholarship(scholarshipData: Omit<Scholarship, 'id' | 'createdAt' | 'updatedAt'>): Promise<string> {\n  console.log(\"[firestoreService] addScholarship (Server Action): Received data:\", scholarshipData);\n  const initialAuthUser = auth.currentUser;\n  console.log(`[firestoreService] addScholarship (Server Action): auth.currentUser?.uid at START of function: ${initialAuthUser?.uid || 'auth.currentUser IS NULL/STALE at start'}`);\n\n  const dataToSave: Partial<Scholarship> & { createdAt: any, updatedAt: any } = {\n    // Ensure all required fields from schema are present or explicitly nulled if optional\n    name: scholarshipData.name || '',\n    description: scholarshipData.description || '',\n    eligibility: scholarshipData.eligibility || '',\n    websiteUrl: scholarshipData.websiteUrl || '',\n    location: scholarshipData.location || 'International', // Default location\n\n    // Optional fields: set to null if not provided or empty string from form\n    iconName: scholarshipData.iconName && scholarshipData.iconName !== '_none_' ? scholarshipData.iconName : null,\n    category: scholarshipData.category || null,\n    ageRequirement: scholarshipData.ageRequirement && scholarshipData.ageRequirement !== '_none_' ? scholarshipData.ageRequirement : null,\n    fundingLevel: scholarshipData.fundingLevel && scholarshipData.fundingLevel !== '_none_' ? scholarshipData.fundingLevel : null,\n    destinationRegion: scholarshipData.destinationRegion && scholarshipData.destinationRegion !== '_none_' ? scholarshipData.destinationRegion : null,\n    targetLevel: scholarshipData.targetLevel && scholarshipData.targetLevel !== '_none_' ? scholarshipData.targetLevel : null,\n    fundingCountry: scholarshipData.fundingCountry && scholarshipData.fundingCountry !== '_none_' ? scholarshipData.fundingCountry : null,\n    partner: scholarshipData.partner || null,\n    coverage: scholarshipData.coverage || null,\n    deadline: scholarshipData.deadline || null,\n    imageUrl: scholarshipData.imageUrl || null, // Assuming empty string from form becomes null via client-side processing or here\n\n    createdAt: serverTimestamp(),\n    updatedAt: serverTimestamp(),\n  };\n  \n  delete (dataToSave as any).id; \n  \n  try {\n    const scholarshipsRef = collection(db, SCHOLARSHIPS_COLLECTION);\n    console.log(\"[firestoreService] addScholarship (Server Action): Attempting to save data to Firestore:\", dataToSave);\n    console.log(`[firestoreService] addScholarship (Server Action): auth.currentUser?.uid JUST BEFORE addDoc: ${auth.currentUser?.uid || 'auth.currentUser IS NULL/STALE before addDoc'}`);\n    \n    const docRef = await addDoc(scholarshipsRef, dataToSave as any);\n    console.log(\"[firestoreService] addScholarship (Server Action): Successfully added document with ID:\", docRef.id);\n    return docRef.id;\n  } catch (error: any) { \n    const currentAuthUserUidInCatch = auth.currentUser?.uid || 'UNKNOWN_UID_IN_SERVER_ACTION_CATCH_BLOCK';\n    console.error(\"--------------------------------------------------------------------\");\n    console.error(\"[firestoreService] CRITICAL ERROR adding scholarship to Firestore (Server Action)!\");\n    console.error(`[firestoreService] UID available in Server Action auth context (auth.currentUser.uid) at time of error: ${currentAuthUserUidInCatch}`);\n    console.error(\"[firestoreService] Original Firebase Error Object:\", error);\n    console.error(\"[firestoreService] Firebase Error Code:\", error.code); \n    console.error(\"[firestoreService] Firebase Error Message:\", error.message); \n    if (error.details) console.error(\"[firestoreService] Firebase Error Details:\", error.details);\n    console.error(\"[firestoreService] Data that was ATTEMPTED TO SAVE:\", dataToSave);\n    console.error(\"--------------------------------------------------------------------\");\n    \n    if (error.code === 'permission-denied' || (error.message && error.message.includes('PERMISSION_DENIED'))) {\n      const detailedErrorMessage =\n        `ACTION REQUIRED: Firestore Permission Denied when Server Action 'addScholarship' tried to write. ` +\n        `Firebase Original Message: \"${error.message}\". ` +\n        `This usually means 'request.auth' was 'null' in your Firestore security rules because the Server Action's execution context was not recognized as authenticated by Firebase when using the client SDK. ` +\n        `UID available in Server Action's auth context (auth.currentUser.uid) at time of error: '${currentAuthUserUidInCatch}'. ` +\n        `Client-side logs (from form submission) should show the UID the client believes is active. ` +\n        `TROUBLESHOOTING STEPS FOR SERVER ACTION PERMISSIONS: ` +\n        `1. VERIFY FIREBASE RULES: The rule is likely 'allow create: if request.auth != null && get(/.../USERS/$(request.auth.uid)).data.role == \"Admin\";'. The 'request.auth != null' part is likely the point of failure in the server context. ` +\n        `2. SERVER ACTION AUTH CONTEXT: Using the Firebase *client* SDK in Server Actions for writes requires careful handling of authentication context. 'auth.currentUser' from client SDK is often null/stale on server. ` +\n        `3. Consider using Firebase Admin SDK for backend operations if this pattern persists. Admin SDK calls from a trusted server environment can bypass client security rules if needed, or impersonate users. ` +\n        `4. SIMULATOR: Use Firestore Rules Simulator: Test with 'request.auth' as NULL (simulating unauthenticated server call), and then as your admin UID to see how the rule 'get(/.../USERS/$(request.auth.uid))' behaves. ` +\n        `5. SERVER LOGS: Examine the full original Firebase error and the 'auth.currentUser.uid' logs in your SERVER CONSOLE (Next.js terminal).`;\n      throw new Error(detailedErrorMessage);\n    }\n    throw new Error(`Failed to add scholarship. Server error: ${error.message || 'Please check server console for details.'}`);\n  }\n}\n\nexport async function updateScholarship(id: string, scholarshipData: Partial<Omit<Scholarship, 'id' | 'createdAt'>>): Promise<void> {\n  console.log(`[firestoreService] updateScholarship (Server Action): Received data for ID ${id}:`, scholarshipData);\n  const initialAuthUser = auth.currentUser;\n  console.log(`[firestoreService] updateScholarship (Server Action): auth.currentUser?.uid at START of function: ${initialAuthUser?.uid || 'auth.currentUser IS NULL/STALE at start'}`);\n  \n  const dataToUpdate: { [key: string]: any } = {};\n  (Object.keys(scholarshipData) as Array<keyof typeof scholarshipData>).forEach(key => {\n      const value = scholarshipData[key];\n      if (value === undefined || value === null || value === '_none_') {\n          dataToUpdate[key] = null;\n      } else if (typeof value === 'string' && value.trim() === '' && \n                 (key === 'imageUrl' || key === 'iconName' || key === 'category' || \n                  key === 'ageRequirement' || key === 'fundingLevel' || key === 'destinationRegion' || \n                  key === 'targetLevel' || key === 'fundingCountry' || key === 'partner' || \n                  key === 'coverage' || key === 'deadline')) {\n          dataToUpdate[key] = null;\n      }\n      else {\n          dataToUpdate[key] = value;\n      }\n  });\n  dataToUpdate.updatedAt = serverTimestamp();\n\n  try {\n    const scholarshipDocRef = doc(db, SCHOLARSHIPS_COLLECTION, id);\n    console.log(`[firestoreService] updateScholarship (Server Action): Attempting to update data in Firestore (ID: ${id}):`, dataToUpdate);\n    console.log(`[firestoreService] updateScholarship (Server Action): auth.currentUser?.uid JUST BEFORE updateDoc: ${auth.currentUser?.uid || 'auth.currentUser IS NULL/STALE before updateDoc'}`);\n    await updateDoc(scholarshipDocRef, dataToUpdate);\n    console.log(`[firestoreService] updateScholarship (Server Action): Successfully updated document with ID: ${id}`);\n  } catch (error: any) {\n    const currentAuthUserUidInCatch = auth.currentUser?.uid || 'UNKNOWN_UID_IN_SERVER_ACTION_CATCH_BLOCK';\n    console.error(\"--------------------------------------------------------------------\");\n    console.error(`[firestoreService] ERROR updating scholarship ${id} in Firestore (Server Action)!`);\n    console.error(`[firestoreService] UID available in Server Action auth context (auth.currentUser.uid) at time of error: ${currentAuthUserUidInCatch}`);\n    console.error(\"[firestoreService] Original Firebase Error Object (update):\", error);\n    console.error(\"[firestoreService] Firebase Error Code (update):\", error.code);\n    console.error(\"[firestoreService] Firebase Error Message (update):\", error.message);\n    if (error.details) console.error(\"[firestoreService] Firebase Error Details (update):\", error.details);\n    console.error(\"[firestoreService] Data that was ATTEMPTED TO UPDATE (ID: \" + id + \"):\", dataToUpdate);\n    console.error(\"--------------------------------------------------------------------\");\n    \n    if (error.code === 'permission-denied' || (error.message && error.message.includes('PERMISSION_DENIED'))) {\n        const detailedErrorMessage =\n          `ACTION REQUIRED: Firestore Permission Denied when Server Action 'updateScholarship' tried to write (ID: ${id}). ` +\n          `Firebase Original Message: \"${error.message}\". ` +\n          `This usually means 'request.auth' was 'null' in your Firestore security rules because the Server Action's execution context was not recognized as authenticated by Firebase when using the client SDK. ` +\n          `UID available in Server Action's auth context (auth.currentUser.uid) at time of error: '${currentAuthUserUidInCatch}'. ` +\n          `TROUBLESHOOTING STEPS FOR SERVER ACTION PERMISSIONS: ` +\n          `1. VERIFY FIREBASE RULES: Rule is 'allow update: if request.auth != null && get(/.../USERS/$(request.auth.uid)).data.role == \"Admin\";'. The 'request.auth != null' part is likely failing. ` +\n          `2. AUTH CONTEXT: Using the Firebase *client* SDK in Server Actions for writes requires careful handling of authentication context. ` +\n          `3. ADMIN SDK: Consider Firebase Admin SDK for backend operations. ` +\n          `4. SIMULATOR: Use Firestore Rules Simulator with 'request.auth' as NULL and then as your admin UID. ` +\n          `5. SERVER LOGS: Examine the full original Firebase error and auth logs in your SERVER CONSOLE.`;\n        throw new Error(detailedErrorMessage);\n    }\n    throw new Error(`Failed to update scholarship ${id}. Server error: ${error.message || 'Unknown Firestore error. Check server console for full details.'}`);\n  }\n}\n\nexport async function deleteScholarship(id: string): Promise<void> {\n  console.log(`[firestoreService] deleteScholarship (Server Action): Attempting to delete ID: ${id}`);\n  const initialAuthUser = auth.currentUser;\n  console.log(`[firestoreService] deleteScholarship (Server Action): auth.currentUser?.uid at START of function: ${initialAuthUser?.uid || 'auth.currentUser IS NULL/STALE at start'}`);\n  try {\n    const scholarshipDocRef = doc(db, SCHOLARSHIPS_COLLECTION, id);\n    console.log(`[firestoreService] deleteScholarship (Server Action): auth.currentUser?.uid JUST BEFORE deleteDoc: ${auth.currentUser?.uid || 'auth.currentUser IS NULL/STALE before deleteDoc'}`);\n    await deleteDoc(scholarshipDocRef);\n    console.log(`[firestoreService] deleteScholarship (Server Action): Successfully deleted document with ID: ${id}`);\n  } catch (error: any) {\n    const currentAuthUserUidInCatch = auth.currentUser?.uid || 'UNKNOWN_UID_IN_SERVER_ACTION_CATCH_BLOCK';\n    console.error(`[firestoreService] Error deleting scholarship ${id} (Server Action): `, error);\n    if (error.code === 'permission-denied' || (error.message && error.message.includes('PERMISSION_DENIED'))) {\n        const detailedErrorMessage =\n          `ACTION REQUIRED: Firestore Permission Denied when Server Action 'deleteScholarship' tried to delete (ID: ${id}). ` +\n          `Firebase Original Message: \"${error.message}\". ` +\n          `This usually means 'request.auth' was 'null' in Firestore rules. ` +\n          `UID available in Server Action's auth context at time of error: '${currentAuthUserUidInCatch}'. ` +\n          `TROUBLESHOOTING: Check rule 'allow delete: if request.auth != null && get(/.../USERS/$(request.auth.uid)).data.role == \"Admin\";', auth context in Server Actions, or consider Admin SDK. Use Rules Simulator. Check SERVER LOGS.`;\n        throw new Error(detailedErrorMessage);\n    }\n    throw new Error(`Failed to delete scholarship ${id}.`);\n  }\n}\n\nexport async function seedInitialScholarships(scholarshipsToSeed: Omit<Scholarship, 'id' | 'createdAt' | 'updatedAt'>[]): Promise<void> {\n  console.log(\"[firestoreService] seedInitialScholarships (Server Action): Checking if seeding is needed.\");\n  const scholarshipsRef = collection(db, SCHOLARSHIPS_COLLECTION);\n  \n  // Check if ANY scholarships exist. If so, don't seed.\n  const existingQuerySnapshot = await getDocs(query(scholarshipsRef, orderBy('createdAt', 'desc')));\n  if (!existingQuerySnapshot.empty) {\n      console.log(`[firestoreService] seedInitialScholarships: Found ${existingQuerySnapshot.size} existing scholarships. Seeding aborted to prevent duplicates.`);\n      return;\n  }\n\n  console.log(\"[firestoreService] seedInitialScholarships: No existing scholarships found. Proceeding with seeding.\");\n  const batch = writeBatch(db);\n  let seededCount = 0;\n\n  scholarshipsToSeed.forEach(scholarship => {\n    const newDocRef = doc(scholarshipsRef); \n    const dataToSave = {\n      ...scholarship,\n      iconName: scholarship.iconName && scholarship.iconName !== '_none_' ? scholarship.iconName : null,\n      category: scholarship.category || null,\n      ageRequirement: scholarship.ageRequirement && scholarship.ageRequirement !== '_none_' ? scholarship.ageRequirement : null,\n      fundingLevel: scholarship.fundingLevel && scholarship.fundingLevel !== '_none_' ? scholarship.fundingLevel : null,\n      destinationRegion: scholarship.destinationRegion && scholarship.destinationRegion !== '_none_' ? scholarship.destinationRegion : null,\n      targetLevel: scholarship.targetLevel && scholarship.targetLevel !== '_none_' ? scholarship.targetLevel : null,\n      fundingCountry: scholarship.fundingCountry && scholarship.fundingCountry !== '_none_' ? scholarship.fundingCountry : null,\n      partner: scholarship.partner || null,\n      coverage: scholarship.coverage || null,\n      deadline: scholarship.deadline || null,\n      imageUrl: scholarship.imageUrl || null,\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp(),\n    };\n    batch.set(newDocRef, dataToSave);\n    seededCount++;\n  });\n\n  if (seededCount > 0) {\n    try {\n      await batch.commit();\n      console.log(`[firestoreService] seedInitialScholarships: Successfully seeded ${seededCount} new scholarships.`);\n    } catch (error: any) {\n      console.error(\"[firestoreService] seedInitialScholarships: Error committing seed batch:\", error);\n      // Even if seeding fails, we re-throw. The admin needs to be aware.\n      // The error message construction here matches other permission denied errors for consistency.\n       const currentAuthUserUidInCatch = auth.currentUser?.uid || 'UNKNOWN_UID_IN_SERVER_ACTION_CATCH_BLOCK_SEEDING';\n       if (error.code === 'permission-denied' || (error.message && error.message.includes('PERMISSION_DENIED'))) {\n         const detailedErrorMessage =\n           `ACTION REQUIRED: Firestore Permission Denied when Server Action 'seedInitialScholarships' tried to write. ` +\n           `Firebase Original Message: \"${error.message}\". ` +\n           `UID available in Server Action's auth context at time of error: '${currentAuthUserUidInCatch}'. ` +\n           `Ensure the account performing this action (if any is relevant for seeding) has permissions or that rules allow unauthenticated writes IF seeding is meant to be unprotected (not recommended for general ops).`;\n         throw new Error(detailedErrorMessage);\n       }\n      throw new Error(`Failed to seed scholarships. Server error: ${error.message || 'Please check server console for details.'}`);\n    }\n  } else {\n    console.log(\"[firestoreService] seedInitialScholarships: No new scholarships were in the provided seed data or all were filtered out.\");\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 447, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/admin/scholarships/new/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {addScholarship as '40ee7735011f21c88853ae4326339fd5265dfa4393'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 499, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/admin/scholarships/new/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/admin/scholarships/new/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/admin/scholarships/new/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA2S,GACxU,yEACA","debugId":null}},
    {"offset": {"line": 513, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/admin/scholarships/new/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/admin/scholarships/new/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/admin/scholarships/new/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAuR,GACpT,qDACA","debugId":null}},
    {"offset": {"line": 527, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}